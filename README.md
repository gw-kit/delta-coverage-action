# Delta Coverage Report GitHub Action

The action creates check run with detailed coverage info based on the Delta-Coverage summary report.
Also, the action creates a comment in the pull request with links to the check runs.

## Inputs

- `title` (optional): The title of the comment. Default is `Delta Coverage Check`.
- `summary-report-path`: The path to the Delta-Coverage summary report json file.
- `suppress-check-failures` (optional): Suppress check run failures.
   If a PR contains label `suppress-delta-coverage` then the default value is `true`, otherwise `false`.
   Can be useful when you want to ignore coverage check failures.
- `github-token` (optional): The GitHub token to use for authentication.

If `title` is not blank then the previous comment generated by this action will be updated with the new report,
otherwise a new comment will be created.

## Outputs

- `badges-dir` - The directory where the coverage badges are stored.

## Pre-requisites

Required permissions:
- issues: `read`
- pull-requests: `write`
- checks: `write`


## Example usage

```yaml
jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      issues: read
      pull-requests: write
      checks: write
          
    steps:
      - name: Publish Delta Coverage Report
        uses: gw-kit/delta-coverage-action@main
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
```

## Coverage Badges

The action generates coverage badges for each [coverage view](https://github.com/gw-kit/delta-coverage-plugin/blob/main/README.md#report-views).
The badges are generated based on _full coverage summary_ data files created by [Delta-Coverage plugin](https://github.com/gw-kit/delta-coverage-plugin).

⚠️ Enabling of full coverage report is required:
```kts
deltaCoverageReport {
   reports {
      fullCoverageReport = true
   }
}
```

### Badges example

![aggregated.svg](https://raw.githubusercontent.com/gw-kit/coverage-badges/refs/heads/main/delta-coverage-plugin/badges/aggregated.svg)
![functionalTest.svg](https://raw.githubusercontent.com/gw-kit/coverage-badges/refs/heads/main/delta-coverage-plugin/badges/functionalTest.svg)
![test.svg](https://raw.githubusercontent.com/gw-kit/coverage-badges/refs/heads/main/delta-coverage-plugin/badges/test.svg)
